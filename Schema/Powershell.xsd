<?xml version="1.0" encoding="UTF-8" ?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:element name="Machine">
        <xs:complexType>
            <xs:sequence>
                <xs:element name="UpdateStamp" minOccurs="1" maxOccurs="1">
                    <xs:annotation>
                        <xs:documentation>
                            Stamp to see what was the latest update script that was ran
                        </xs:documentation>
                    </xs:annotation>
                    <xs:complexType>
                        <xs:simpleContent>
                            <xs:extension base="xs:string">
                                <xs:attribute name="Value" type="xs:string" use="required"/>
                            </xs:extension>
                        </xs:simpleContent>
                    </xs:complexType>
                </xs:element>
                <!-- Start Script -->
                <xs:element name="Start" minOccurs="1" maxOccurs="1">
                    <xs:annotation>
                        <xs:documentation>
                            Full path to the powershell script.  This will execute after profile is loaded
                        </xs:documentation>
                    </xs:annotation>
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="Script" minOccurs="0" maxOccurs="1" type="xs:string">
                                <xs:annotation>
                                    <xs:documentation>
                                        This script will be run after the load procedures finish
                                    </xs:documentation>
                                </xs:annotation>
                            </xs:element>
                            <xs:element name="Greetings" minOccurs="0" maxOccurs="1">
                                <xs:annotation>
                                    <xs:documentation>
                                        The string that will passed with the link.
                                    </xs:documentation>
                                </xs:annotation>
                                <xs:complexType>
                                    <xs:simpleContent>
                                        <xs:extension base="xs:string">
                                            <xs:attribute name="Type" use="optional" type="xs:string">
                                                <xs:annotation>
                                                    <xs:documentation>
                                                        Default is 'Graffiti'. Visit http://patorjk.com/software/taag/ for more information on the different type
                                                    </xs:documentation>
                                                </xs:annotation>
                                            </xs:attribute>
                                            <xs:attribute name="Save" use="optional">
                                                <xs:annotation>
                                                    <xs:documentation>
                                                        If you want to save to a file.  Good if you do not have internet connection
                                                    </xs:documentation>
                                                </xs:annotation>
                                                <xs:simpleType>
                                                    <xs:restriction base="xs:string">
                                                        <xs:enumeration value="True"/>
                                                        <xs:enumeration value="False"/>
                                                    </xs:restriction>
                                                </xs:simpleType>
                                            </xs:attribute>
                                        </xs:extension>
                                    </xs:simpleContent>
                                </xs:complexType>
                            </xs:element>
                        </xs:sequence>
                        <xs:attribute name="ClearHost" use="required">
                            <xs:annotation>
                                <xs:documentation>
                                    Default is false.  Suggest to keep it false for debug.
                                </xs:documentation>
                            </xs:annotation>
                                <xs:simpleType>
                                    <xs:restriction base="xs:string">
                                        <xs:enumeration value="True"/>
                                        <xs:enumeration value="False"/>
                                    </xs:restriction>
                                </xs:simpleType>
                        </xs:attribute>
                        <xs:attributeGroup ref="Enable"/>
                    </xs:complexType>
                </xs:element>

                <!-- Terminal Settings -->
                <xs:element name="ShellSettings" minOccurs="1" maxOccurs="1">
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="Format" minOccurs="1" maxOccurs="1">
                                <xs:annotation>
                                    <xs:documentation>
                                        This format applies to all under ShellSettings
                                    </xs:documentation>
                                </xs:annotation>
                                <xs:complexType>
                                    <xs:sequence>
                                        <xs:group ref="Formatter"/>
                                    </xs:sequence>
                                </xs:complexType>
                            </xs:element>
                            <xs:element name="Header" minOccurs="1" maxOccurs="1">
                                <xs:complexType>
                                    <xs:sequence>
                                        <xs:group ref="String"/>
                                        <xs:element name="BackgroundColor" minOccurs="0" maxOccurs="1"/>
                                    </xs:sequence>
                                    <xs:attributeGroup ref="Enable"/>
                                </xs:complexType>
                            </xs:element>
                            <xs:element name="Prompt" minOccurs="1" maxOccurs="1">
                                <xs:annotation>
                                    <xs:documentation>
                                        Change the prompt function in the string tag.  
                                        Any change here does not require a reload of powershell session
                                    </xs:documentation>
                                </xs:annotation>
                                <xs:complexType>
                                    <xs:sequence>
                                        <xs:element name="BaterryLifeThreshold" minOccurs="1" maxOccurs="1">
                                            <xs:annotation>
                                                <xs:documentation>
                                                    The value will change the prompt on the command line to red if your battery life falls below that value
                                                </xs:documentation>
                                            </xs:annotation>
                                            <xs:complexType>
                                                <xs:simpleContent>
                                                    <xs:extension base="xs:string">
                                                        <xs:attributeGroup ref="Enable"/>
                                                    </xs:extension>
                                                </xs:simpleContent>
                                            </xs:complexType>
                                        </xs:element>
                                        <xs:group ref="String"/>
                                    </xs:sequence>
                                    <xs:attributeGroup ref="Enable"/>
                                </xs:complexType>
                            </xs:element>
                            <xs:element name="ShellColors" maxOccurs="1">
                                <xs:complexType>
                                    <xs:sequence>
                                        <xs:element name="BackgroundColor" minOccurs="0" maxOccurs="1"/>
                                        <xs:element name="ForegroundColor" minOccurs="0" maxOccurs="1"/>
                                        <xs:element name="ProgressForegroundColor" minOccurs="0" maxOccurs="1"/>
                                        <xs:element name="ProgressBackgroundColor" minOccurs="0" maxOccurs="1"/>
                                    </xs:sequence>
                                </xs:complexType>
                            </xs:element>
                            <xs:element name="StartDirectory" type="xs:string" maxOccurs="1">
                                <xs:annotation>
                                    <xs:documentation>
                                        Default is whatever is configured in the app settings
                                    </xs:documentation>
                                </xs:annotation>
                            </xs:element>
                            <xs:element name="GitDisplay" minOccurs="0" maxOccurs="1">
                                <xs:annotation>
                                    <xs:documentation>
                                        Git notificatons for Unstaged/Staged changes and unpushed commits
                                    </xs:documentation>
                                </xs:annotation>
                                <xs:complexType>
                                    <xs:sequence>
                                        <xs:element name="Unstaged" minOccurs="0" maxOccurs="1">
                                            <xs:simpleType>
                                                <xs:restriction base="xs:string">
                                                    <xs:enumeration value="True"/>
                                                    <xs:enumeration value="False"/>
                                                </xs:restriction>
                                            </xs:simpleType>
                                        </xs:element>
                                        <xs:element name="Staged" minOccurs="0" maxOccurs="1">
                                            <xs:simpleType>
                                                <xs:restriction base="xs:string">
                                                    <xs:enumeration value="True"/>
                                                    <xs:enumeration value="False"/>
                                                </xs:restriction>
                                            </xs:simpleType>
                                        </xs:element>
                                        <xs:element name="Commits" minOccurs="0" maxOccurs="1">
                                            <xs:simpleType>
                                                <xs:restriction base="xs:string">
                                                    <xs:enumeration value="True"/>
                                                    <xs:enumeration value="False"/>
                                                </xs:restriction>
                                            </xs:simpleType>
                                        </xs:element>
                                    </xs:sequence>
                                    <xs:attributeGroup ref="Enable"/>
                                </xs:complexType>
                            </xs:element>
                            <xs:element name="Security" minOccurs="0" maxOccurs="1">
                                <xs:complexType>
                                    <xs:sequence>
                                        <xs:element name="Secure" minOccurs="0" maxOccurs="1">
                                            <xs:annotation>
                                                <xs:documentation>
                                                    Should user be prompted for credentials.  Uses basic .json non-encrypted file to hold credentials in \bin\credentials\user.json
                                                </xs:documentation>
                                            </xs:annotation>
                                            <xs:simpleType>
                                                <xs:restriction base="xs:string">
                                                    <xs:enumeration value="True"/>
                                                    <xs:enumeration value="False"/>
                                                </xs:restriction>
                                            </xs:simpleType>
                                        </xs:element>
                                        <xs:element name="CloseSessionIfIncorrect" minOccurs="0" maxOccurs="1">
                                            <xs:simpleType>
                                                <xs:restriction base="xs:string">
                                                    <xs:enumeration value="True"/>
                                                    <xs:enumeration value="False"/>
                                                </xs:restriction>
                                            </xs:simpleType>
                                        </xs:element>
                                    </xs:sequence>
                                </xs:complexType>
                            </xs:element>
                        </xs:sequence>
                        <xs:attributeGroup ref="Enable"/>
                    </xs:complexType>
                </xs:element>

                <xs:element name="GitSettings" minOccurs="0" maxOccurs="1">
                    
                </xs:element>

                <xs:element name="Weather" minOccurs="0" maxOccurs="1">
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="Area" minOccurs="0" maxOccurs="1">
                                <xs:annotation>
                                    <xs:documentation>
                                        City for weather
                                    </xs:documentation>
                                </xs:annotation>
                            </xs:element>
                        </xs:sequence>
                    </xs:complexType>
                </xs:element>

                <xs:element name="Email" minOccurs="0" maxOccurs="1">
                    <xs:annotation>
                        <xs:documentation>
                            Settings for Email.ps1
                        </xs:documentation>
                    </xs:annotation>
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="EmailAddress" minOccurs="0" maxOccurs="1">
                                <xs:annotation>
                                    <xs:documentation>
                                        The Email address you want to read your emails from 
                                    </xs:documentation>
                                </xs:annotation>
                                <xs:complexType>
                                    <xs:simpleContent>
                                        <xs:extension base="xs:string">
                                            <xs:attributeGroup ref="SecurityType"/>
                                        </xs:extension>
                                    </xs:simpleContent>
                                </xs:complexType>
                            </xs:element>
                            <xs:element name="DefaultFolder" type="xs:string"  minOccurs="0" maxOccurs="1">
                                <xs:annotation>
                                    <xs:documentation>
                                        Folder you are reading from (i.e. the \Inbox folder)
                                    </xs:documentation>
                                </xs:annotation>
                            </xs:element>
                            <xs:element name="IncludeFields" minOccurs="0" maxOccurs="1">
                                <xs:annotation>
                                    <xs:documentation>
                                        What to print when listing mail from inbox.  Default is false;
                                    </xs:documentation>
                                </xs:annotation>
                                <xs:complexType>
                                    <xs:sequence>
                                        <xs:element name="To" minOccurs="0" maxOccurs="1">
                                            <xs:simpleType>
                                                <xs:restriction base="xs:string">
                                                    <xs:enumeration value="True"/>
                                                    <xs:enumeration value="False"/>
                                                </xs:restriction>
                                            </xs:simpleType>
                                        </xs:element>
                                        <xs:element name="CC" minOccurs="0" maxOccurs="1">
                                            <xs:simpleType>
                                                <xs:restriction base="xs:string">
                                                    <xs:enumeration value="True"/>
                                                    <xs:enumeration value="False"/>
                                                </xs:restriction>
                                            </xs:simpleType>
                                        </xs:element>
                                        <xs:element name="From" minOccurs="0" maxOccurs="1">
                                            <xs:simpleType>
                                                <xs:restriction base="xs:string">
                                                    <xs:enumeration value="True"/>
                                                    <xs:enumeration value="False"/>
                                                </xs:restriction>
                                            </xs:simpleType>
                                        </xs:element>
                                        <xs:element name="Subject" minOccurs="0" maxOccurs="1">
                                            <xs:simpleType>
                                                <xs:restriction base="xs:string">
                                                    <xs:enumeration value="True"/>
                                                    <xs:enumeration value="False"/>
                                                </xs:restriction>
                                            </xs:simpleType>
                                        </xs:element>
                                        <xs:element name="Body" minOccurs="0" maxOccurs="1">
                                            <xs:simpleType>
                                                <xs:restriction base="xs:string">
                                                    <xs:enumeration value="True"/>
                                                    <xs:enumeration value="False"/>
                                                </xs:restriction>
                                            </xs:simpleType>
                                        </xs:element>
                                    </xs:sequence>
                                </xs:complexType>
                            </xs:element>
                            <xs:element name="OutByPaging" type="xs:boolean" minOccurs="0" maxOccurs="1">
                                <xs:annotation>
                                    <xs:documentation>
                                        Default is False.  If you want to output the message by page
                                    </xs:documentation>
                                </xs:annotation>
                            </xs:element>
                            <xs:element name="ListInboxMax" type="xs:int" minOccurs="0" maxOccurs="1"/>
                            <xs:element name="ListOrderBy" minOccurs="0" maxOccurs="1">
                                <xs:simpleType>
                                    <xs:restriction base="xs:string" >
                                        <xs:enumeration value="Asc">
                                            <xs:annotation>
                                                <xs:documentation>
                                                    Ascending
                                                </xs:documentation>
                                            </xs:annotation>
                                        </xs:enumeration>
                                        <xs:enumeration value="Desc">
                                            <xs:annotation>
                                                <xs:documentation>
                                                    Descending
                                                </xs:documentation>
                                            </xs:annotation>
                                        </xs:enumeration>
                                    </xs:restriction>
                                </xs:simpleType>
                            </xs:element>
                        </xs:sequence>
                        <xs:attribute name="AssemblyPath" type="xs:string" use="optional">
                            <xs:annotation>
                                <xs:documentation>
                                    In Powershell 7 (as far as I know) The add-Type AssemblyName parameter needs the full file path.
                                </xs:documentation>
                            </xs:annotation>
                        </xs:attribute>
                    </xs:complexType>
                </xs:element>

                <xs:element name="NetDrives" minOccurs="0" maxOccurs="1">
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="NetDrive" minOccurs="0" maxOccurs="unbounded">
                                <xs:complexType>
                                    <xs:sequence>
                                        <xs:element name="Connection" minOccurs="0" maxOccurs="unbounded">
                                            <xs:complexType>
                                                <xs:sequence>
                                                    <xs:element name="DriveLetter" minOccurs="0" maxOccurs="1" type="xs:string"/>
                                                    <xs:element name="PuttyPath" minOccurs="0" maxOccurs="1" type="xs:string"/>
                                                    <xs:element name="IPAddress" minOccurs="0" maxOccurs="1">
                                                        <xs:complexType>
                                                            <xs:simpleContent>
                                                                <xs:extension base="xs:string">
                                                                    <xs:attributeGroup ref="SecurityType"/>
                                                                </xs:extension>
                                                            </xs:simpleContent>
                                                        </xs:complexType>
                                                    </xs:element>   
                                                    <xs:element name="Port" minOccurs="0" maxOccurs="1" type="xs:string"/>
                                                    <xs:element name="Username" minOccurs="0" maxOccurs="1">
                                                        <xs:complexType>
                                                            <xs:simpleContent>
                                                                <xs:extension base="xs:string">
                                                                    <xs:attributeGroup ref="SecurityType"/>
                                                                </xs:extension>
                                                            </xs:simpleContent>
                                                        </xs:complexType>
                                                    </xs:element>   
                                                    <xs:element name="Password" minOccurs="0" maxOccurs="1">
                                                        <xs:annotation>
                                                            <xs:documentation>
                                                                If you do not provide then you will be prompted
                                                            </xs:documentation>
                                                        </xs:annotation>
                                                        <xs:complexType>
                                                            <xs:simpleContent>
                                                                <xs:extension base="xs:string">
                                                                    <xs:attributeGroup ref="SecurityType"/>
                                                                </xs:extension>
                                                            </xs:simpleContent>
                                                        </xs:complexType>
                                                    </xs:element> 
                                                    <xs:element name="SSH" minOccurs="0" maxOccurs="1">
                                                        <xs:complexType>
                                                            <xs:simpleContent>
                                                                <xs:extension base="xs:string">
                                                                    <xs:attributeGroup ref="SecurityType"/>
                                                                </xs:extension>
                                                            </xs:simpleContent>
                                                        </xs:complexType>
                                                    </xs:element>   
                                                </xs:sequence>
                                                <xs:attribute name="Type" use="required">
                                                    <xs:simpleType>
                                                        <xs:restriction base="xs:string">
                                                            <xs:enumeration value="NetworkShare">
                                                                <xs:annotation>
                                                                    <xs:documentation>
                                                                        For network shared folders
                                                                    </xs:documentation>
                                                                </xs:annotation>
                                                            </xs:enumeration>
                                                            <xs:enumeration value="Putty">
                                                                <xs:annotation>
                                                                    <xs:documentation>
                                                                        For ssh putty
                                                                    </xs:documentation>
                                                                </xs:annotation>
                                                            </xs:enumeration>
                                                        </xs:restriction>
                                                    </xs:simpleType>
                                                </xs:attribute>
                                            </xs:complexType>
                                        </xs:element>
                                    </xs:sequence>
                                    <xs:attribute name="HostName" use="required"/>
                                </xs:complexType>
                            </xs:element>
                        </xs:sequence>
                    </xs:complexType>                    
                </xs:element>
                
                <xs:element name="Lists" minOccurs="0" maxOccurs="1">
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="List">
                                <xs:complexType>
                                    <xs:sequence>
                                        <xs:group ref="List"/>
                                    </xs:sequence>
                                    <xs:attribute name="Title" use="required"/>
                                </xs:complexType>
                            </xs:element>
                        </xs:sequence>
                    </xs:complexType>
                </xs:element>

                <xs:element name="Calendar" minOccurs="0" maxOccurs="1">
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="SpecialDays" maxOccurs="1">
                                <xs:complexType>
                                    <xs:sequence>
                                        <xs:element name="SpecialDay" minOccurs="1" maxOccurs="unbounded">
                                            <xs:annotation>
                                                <xs:documentation>
                                                    Must be in datetime format: MM/dd/yyyy 
                                                </xs:documentation>
                                            </xs:annotation>
                                            <xs:complexType>
                                                <xs:attribute name="name" type="xs:dateTime" use="required">
                                                    <xs:annotation>
                                                        <xs:documentation>
                                                            Name of the day
                                                        </xs:documentation>
                                                    </xs:annotation>
                                                </xs:attribute>
                                            </xs:complexType>
                                        </xs:element>
                                    </xs:sequence>
                                </xs:complexType>
                            </xs:element>
                        </xs:sequence>
                    </xs:complexType>
                </xs:element>

                <xs:element name="Functions" minOccurs="0" maxOccurs="1">
                    <xs:annotation>
                        <xs:documentation>
                            This is where you can set some functions that isn't already defined in this repo.  
                        </xs:documentation>
                    </xs:annotation>
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="Function" type="xs:string" minOccurs="0" maxOccurs="unbounded">
                                <xs:annotation>
                                    <xs:documentation>
                                        Must be within a cdata section
                                    </xs:documentation>
                                </xs:annotation>
                            </xs:element>
                        </xs:sequence>
                    </xs:complexType>
                </xs:element>

                <xs:element name="Modules" maxOccurs="1">
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="Module" type="xs:anyURI" minOccurs="0" maxOccurs="unbounded">
                                <xs:annotation>
                                    <xs:documentation> <!-- TODO include modules outside repo if it isn't imported -->
                                        Full file path to the module
                                    </xs:documentation>
                                </xs:annotation>
                            </xs:element>
                        </xs:sequence>
                    </xs:complexType>
                </xs:element>

                <xs:element name="Directories" maxOccurs="1">
                    <xs:annotation>
                        <xs:documentation>
                            Parameters that are used in Goto.ps1 nad put.ps1 function
                        </xs:documentation>
                    </xs:annotation>
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="Directory" minOccurs="1" maxOccurs="unbounded">
                                <xs:annotation>
                                    <xs:documentation>
                                        File path for alias
                                    </xs:documentation>
                                </xs:annotation>
                                <xs:complexType>
                                    <xs:simpleContent>
                                        <xs:extension base="xs:anyURI">
                                            <xs:attribute name="Alias" type="xs:string" use="required"/>
                                            <xs:attributeGroup ref="SecurityType"/>
                                        </xs:extension>
                                    </xs:simpleContent>
                                </xs:complexType>
                            </xs:element>
                        </xs:sequence>
                    </xs:complexType>
                </xs:element>

                <xs:element name="Programs" maxOccurs="1">
                    <xs:annotation>
                        <xs:documentation>
                            Whatever is defined here will be referenced by the alias user provides
                        </xs:documentation>
                    </xs:annotation>    
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="Program" minOccurs="0" maxOccurs="unbounded">
                                <xs:annotation>
                                    <xs:documentation>
                                        Path the alias will be calling. If Internal, given path must start in the repo (functions must be in the powershell repo)
                                    </xs:documentation>
                                </xs:annotation>
                                <xs:complexType>
                                    <xs:simpleContent>
                                        <xs:extension base="xs:anyURI">
                                            <xs:attribute name="Alias" use="required" type="xs:string"/>
                                            <xs:attributeGroup ref="SecurityType"/>
                                        </xs:extension>
                                    </xs:simpleContent>
                                </xs:complexType>
                            </xs:element>
                        </xs:sequence>
                    </xs:complexType>
                </xs:element>

                <xs:element name="Objects" maxOccurs="1">
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="Object" minOccurs="0" maxOccurs="unbounded">
                                <xs:annotation>
                                    <xs:documentation>
                                        Must have one Object element for every object you want to refer to on the cmd line.
                                    </xs:documentation>
                                </xs:annotation>
                                <xs:complexType>
                                    <xs:sequence>
                                        <xs:element name="VarName" minOccurs="1" maxOccurs="1">
                                            <xs:annotation>
                                                <xs:documentation>
                                                    To define the object name
                                                </xs:documentation>
                                            </xs:annotation>
                                            <xs:complexType>
                                                <xs:simpleContent>
                                                    <xs:extension base="xs:string">
                                                        <xs:attributeGroup ref="SecurityType"/>
                                                    </xs:extension>
                                                </xs:simpleContent>
                                            </xs:complexType>
                                        </xs:element>
                                        <xs:choice>
                                            <xs:group ref="HashTableObjectElement"/>
                                            <xs:group ref="XMLElement"/>
                                            <xs:group ref="ClassElement"/>
                                            <xs:group ref="LinkedObject"/>
                                        </xs:choice>
                                    </xs:sequence>
                                    <xs:attribute name="Type" use="required">
                                        <xs:annotation>
                                            <xs:documentation>
                                                Values: PowerShellClass (if there is a class in the Classes folder the object is building from),  
                                                XmlElement (if object will inherit objects from Xml elements -- needs varname attribute),  
                                                HashTable (if the object will be using key and value to populate).   
                                                Default is XmlElement.
                                            </xs:documentation>
                                        </xs:annotation>
                                        <xs:simpleType>
                                            <xs:restriction base="xs:string">
                                                <xs:enumeration value="PowerShellClass">
                                                    <xs:annotation>
                                                        <xs:documentation>
                                                            A PowerShell Class object is an object whose datatype is defined by a class in this repository
                                                        </xs:documentation>
                                                    </xs:annotation>
                                                </xs:enumeration>
                                                <xs:enumeration value="XmlElement">
                                                    <xs:annotation>
                                                        <xs:documentation>
                                                            An XmlElement is an object that is the XmlElement defined in the configuration
                                                        </xs:documentation>
                                                    </xs:annotation>
                                                </xs:enumeration>
                                                <xs:enumeration value="HashTable">
                                                    <xs:annotation>
                                                        <xs:documentation>
                                                            A hash table object is a hash object whose keys and values are defined by the xml configuration
                                                        </xs:documentation>
                                                    </xs:annotation>
                                                </xs:enumeration>
                                                <xs:enumeration value="LinkedObject">
                                                    <xs:annotation>
                                                        <xs:documentation>
                                                            A linked object is constructed with data defined in the database
                                                        </xs:documentation>
                                                    </xs:annotation>
                                                </xs:enumeration>
                                            </xs:restriction>
                                        </xs:simpleType>
                                    </xs:attribute>
                                    <xs:attribute name="ID" type="xs:int" use="optional">
                                        <xs:annotation>
                                            <xs:documentation>
                                                Optional for HashTable type, use to distinguish objects in config
                                            </xs:documentation>
                                        </xs:annotation>
                                    </xs:attribute>
                                </xs:complexType>
                            </xs:element>
                        </xs:sequence>
                        <xs:attribute name="Database" type="xs:string" use="optional">
                            <xs:annotation>
                                <xs:documentation>
                                    For the HashTable decoding to work, you need to define this attribute
                                </xs:documentation>
                            </xs:annotation>
                        </xs:attribute>
                        <xs:attribute name="ServerInstance" type="xs:string" use="optional">
                            <xs:annotation>
                                <xs:documentation>
                                    For the HashTable decoding to work, you need to define this attribute
                                </xs:documentation>
                            </xs:annotation>
                        </xs:attribute>
                    </xs:complexType>
                </xs:element>
            </xs:sequence>
            <xs:attribute name="MachineName"/>
            <xs:attribute name="LoadProfile"/>
            <xs:attribute name="LoadProcedure">
                <xs:annotation>
                    <xs:documentation>
                        Put "Verbose" to see verbose text.  Without it you will see progress bar
                    </xs:documentation>
                </xs:annotation>
            </xs:attribute>
        </xs:complexType>
    </xs:element>

    <!-- Group definition -->
    <xs:group name="String">
        <xs:sequence>
            <xs:element name="String" minOccurs="1" maxOccurs="1">
                <xs:annotation>
                    <xs:documentation>
                        Tags: @user {User name on computer}, @date {Today's date, can be formatted}, @currdir {Current directory}, 
                        @fulldir {Full directory}, @time {Current time, can be formatted}, @greaterthan {For '>'}, @admin {Signifies if you are in an admin prompt}
                    </xs:documentation>
                </xs:annotation>
                <xs:complexType>
                    <xs:simpleContent>
                        <xs:extension base="xs:string">
                            <xs:attribute name="Color" use="optional">
                                <xs:annotation>
                                    <xs:documentation>
                                        Choices are from powershell foregroundcolor color. 
                                    </xs:documentation>
                                </xs:annotation>
                            </xs:attribute>
                        </xs:extension>
                    </xs:simpleContent>
                </xs:complexType>
            </xs:element>
        </xs:sequence>
    </xs:group>

    <!-- Formatter -->
    <xs:group name="Formatter">
        <xs:sequence>
            <xs:element name="Date" minOccurs="1" maxOccurs="1" type="xs:string">
                <xs:annotation>
                    <xs:documentation>
                        Default is yyyy-dd-MM.  Uses powershell datetime formatting
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
            <xs:element name="Time" minOccurs="1" maxOccurs="1" type="xs:string">
                <xs:annotation>
                    <xs:documentation>
                        Default is hh:mm:ss.  Uses powershell datetime formatting
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
            <xs:element name="GitString" minOccurs="0" maxOccurs="1" type="xs:string">
                <xs:annotation>
                    <xs:documentation>
                        Default is (@gitbranch).  Git string format if included in the string tag.  Must include the @gitbranch tag if it is how you want it to look. 
                        Example: [@gitbranch] = [dev] or {@gitbranch} = {dev}
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
        </xs:sequence>
    </xs:group>


    <xs:attributeGroup name="Enable">
        <xs:attribute name="Enabled" use="required">
            <xs:simpleType>
                <xs:restriction base="xs:string">
                    <xs:enumeration value="True"/>
                    <xs:enumeration value="False"/>
                </xs:restriction>
            </xs:simpleType>
        </xs:attribute>
    </xs:attributeGroup>

    <xs:group name="HashTableObjectElement">
        <xs:sequence>
            <xs:choice maxOccurs="unbounded">
                <xs:group ref="NodeKey"/>
                <xs:group ref="NodeValue"/>
            </xs:choice>
            <xs:choice maxOccurs="unbounded">
                <xs:group ref="NodeValue"/>
                <xs:group ref="NodeKey"/>
            </xs:choice>
        </xs:sequence>
    </xs:group>

    <xs:group name="NodeKey">
        <xs:sequence>
            <xs:element name="Key" minOccurs="0" maxOccurs="unbounded">
                <xs:complexType>
                    <xs:simpleContent>
                        <xs:extension base="xs:string">
                            <xs:attribute name="Node" type="xs:string" use="optional">
                                <xs:annotation>
                                    <xs:documentation>
                                        Unique id for the node pointer to point to
                                    </xs:documentation>
                                </xs:annotation>
                            </xs:attribute>
                            <xs:attributeGroup ref="HashTableObjectAttributes"/>
                        </xs:extension>
                    </xs:simpleContent>
                </xs:complexType>
            </xs:element>
        </xs:sequence>
    </xs:group>

    <xs:group name="NodeValue">
        <xs:sequence>
            <xs:element name="Value" minOccurs="1" maxOccurs="unbounded">
                <xs:complexType>
                    <xs:simpleContent>
                        <xs:extension base="xs:string">
                            <xs:attributeGroup ref="HashTableObjectAttributes"/>
                            <xs:attribute name="Node" type="xs:string" use="optional">
                                <xs:annotation>
                                    <xs:documentation>
                                        Unique id for the node pointer to point to (If you are referencing a powershell object, include '$')
                                    </xs:documentation>
                                </xs:annotation>
                            </xs:attribute>
                            <xs:attribute name="NodePointer" use="optional">
                                <xs:annotation>
                                    <xs:documentation>
                                        Provide a unique id to point to the next node value
                                    </xs:documentation>
                                </xs:annotation>
                            </xs:attribute>
                        </xs:extension>
                    </xs:simpleContent>
                </xs:complexType>
            </xs:element>
        </xs:sequence>
    </xs:group>
    
    <!-- Objects -->
    <xs:attributeGroup name="HashTableObjectAttributes">
        <xs:attribute name="Lvl" use="required">
            <xs:annotation>
                <xs:documentation>
                    Level of the node or hash table (still determining the name)
                </xs:documentation>
            </xs:annotation>
        </xs:attribute>
        <xs:attributeGroup ref="SecurityType"/>
    </xs:attributeGroup>

    <xs:group name="XMLElement">
        <xs:sequence>
            <xs:element name="Values" minOccurs="0" maxOccurs="1">
                <xs:annotation>
                    <xs:documentation>
                        Any node here can be referenced on the command line by the element name.
                    </xs:documentation>
                </xs:annotation>
                <xs:complexType>
                    <xs:sequence maxOccurs="unbounded">
                        <xs:any processContents="strict" namespace="##local"/>
                    </xs:sequence>
                </xs:complexType>
            </xs:element>
        </xs:sequence>
    </xs:group>

    <xs:simpleType name="XMLAny">
        <xs:restriction base="xs:string" />
    </xs:simpleType>
    
    <xs:group name="ClassElement">
        <xs:sequence>
            <xs:element name="Class" minOccurs="0" maxOccurs="1">
                <xs:annotation>
                    <xs:documentation>
                        Nodes below here can be reference when creating a class. 
                    </xs:documentation>
                </xs:annotation>
                <xs:complexType>
                    <xs:sequence>
                        <xs:choice>
                            <xs:group ref="SQLClass"/>
                            <xs:group ref="ListClass"/>
                            <xs:group ref="MathClass"/>
                            <xs:group ref="CalendarClass"/>
                        </xs:choice>
                    </xs:sequence>
                    <xs:attribute name="ClassName" use="required"/>
                    <xs:attribute name="HasParams" use="required" type="xs:boolean"/>
                </xs:complexType>
            </xs:element>
        </xs:sequence>
    </xs:group>
    
    <xs:group name="LinkedObject">
        <xs:sequence>
            <xs:element name="Link" minOccurs="1" maxOccurs="1">
                <xs:annotation>
                    <xs:documentation>
                        This is the guid in the link table that pulls all the required data from the database to make the object
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
        </xs:sequence>
    </xs:group>
    
    <xs:group name="ListClass">
        <xs:sequence>
            <xs:element name="List" maxOccurs="1">
                <xs:complexType>
                    <xs:all>
                        <xs:element name="Title" minOccurs="1">
                            <xs:annotation>
                                <xs:documentation>
                                    The Title of the list you defined in your config
                                </xs:documentation>
                            </xs:annotation>
                        </xs:element>
                        <xs:element name="Redirect" minOccurs="1">
                            <xs:annotation>
                                <xs:documentation>
                                    Provide FULL file path if you are pointing to another xml file for your list.  
                                    Note the config layout for the for the redirected list should be the same as this schema instructs.
                                </xs:documentation>
                            </xs:annotation>
                        </xs:element>
                        <xs:element name="DisplayCompleteWith" type="xs:string" minOccurs="1">
                            <xs:annotation>
                                <xs:documentation>
                                    Default 'ColorCoded'.  Options: 'ColorCoded' or 'Markup'
                                </xs:documentation>
                            </xs:annotation>
                        </xs:element>
                    </xs:all>
                </xs:complexType>
            </xs:element>
        </xs:sequence>
    </xs:group>

    <xs:group name="SQLClass">
        <xs:sequence>
            <xs:element name="SQL" minOccurs="0" maxOccurs="1">
                <xs:annotation>
                    <xs:documentation>
                        This is a way to alter or create a table in a local database
                    </xs:documentation>
                </xs:annotation>
                <xs:complexType>
                    <xs:sequence>
                        <xs:element name="Database" type="xs:string" minOccurs="1" maxOccurs="1"/>
                        <xs:element name="ServerInstance" type="xs:string" minOccurs="1" maxOccurs="1"/>
                        <xs:element name="SyncConfiguration" minOccurs="1" maxOccurs="1">
                            <xs:annotation>
                                <xs:documentation>
                                    Flag to allow the class to update your database from profile load.
                                </xs:documentation>
                            </xs:annotation>
                            <xs:simpleType>
                                <xs:restriction base="xs:string">
                                    <xs:enumeration value="True"/>
                                    <xs:enumeration value="False"/>
                                </xs:restriction>
                            </xs:simpleType>
                        </xs:element>
                        <xs:element name="UpdateVerbose" minOccurs="1" maxOccurs="1">
                            <xs:annotation>
                                <xs:documentation>
                                    Verbose flag for debugging update scripts
                                </xs:documentation>
                            </xs:annotation>
                            <xs:simpleType>
                                <xs:restriction base="xs:string">
                                    <xs:enumeration value="True"/>
                                    <xs:enumeration value="False"/>
                                </xs:restriction>
                            </xs:simpleType>
                        </xs:element>
                        <xs:element name="SQLConvertFlags" type="xs:string" minOccurs="1" maxOccurs="1">
                            <xs:annotation>
                                <xs:documentation>
                                    Names here are the columns you will need to provide in the Rows config
                                </xs:documentation>
                            </xs:annotation>
                        </xs:element>
                        <xs:element name="RunUpdates" minOccurs="1" maxOccurs="1">
                            <xs:simpleType>
                                <xs:restriction base="xs:string">
                                    <xs:enumeration value="True"/>
                                    <xs:enumeration value="False"/>
                                </xs:restriction>
                            </xs:simpleType>
                        </xs:element>
                        <xs:element name="CreateDatabase" minOccurs="1" maxOccurs="1">
                            <xs:annotation>
                                <xs:documentation>
                                    Whether or not you want the code to make the database for you.  Good when you first start using the database.
                                </xs:documentation>
                            </xs:annotation>
                            <xs:simpleType>
                                <xs:restriction base="xs:string">
                                    <xs:enumeration value="True"/>
                                    <xs:enumeration value="False"/>
                                </xs:restriction>
                            </xs:simpleType>
                        </xs:element>
                        <xs:element name="Tables">
                            <xs:complexType>
                                <xs:sequence>
                                    <xs:element name="Table" minOccurs="0" maxOccurs="unbounded">
                                        <xs:complexType>
                                            <xs:sequence>
                                                <xs:element name="Column" minOccurs="0" maxOccurs="unbounded">
                                                    <xs:annotation>
                                                        <xs:documentation>
                                                            All attributes here are important.  Must have a value for each attributes in order for the queries to execute successfully 
                                                        </xs:documentation>
                                                    </xs:annotation>
                                                    <xs:complexType>
                                                        <xs:sequence>
                                                            <xs:element name="ForeignKeyRef" type="xs:string" minOccurs="0" maxOccurs="1">
                                                                <xs:annotation>
                                                                    <xs:documentation>
                                                                        If there is a foreign key, must include the .json script
                                                                    </xs:documentation>
                                                                </xs:annotation>
                                                            </xs:element>
                                                        </xs:sequence>
                                                        <xs:attribute name="Name" type="xs:string" use="required">
                                                            <xs:annotation>
                                                                <xs:documentation>
                                                                    Name of the column
                                                                </xs:documentation>
                                                            </xs:annotation>
                                                        </xs:attribute>
                                                        <xs:attribute name="Type" use="required">
                                                            <xs:annotation>
                                                                <xs:documentation>
                                                                    Column data type
                                                                </xs:documentation>
                                                            </xs:annotation>
                                                        </xs:attribute>
                                                        <xs:attribute name="IsPrimaryKey" use="required">
                                                            <xs:annotation>
                                                                <xs:documentation>
                                                                    If this column is the primary key
                                                                </xs:documentation>
                                                            </xs:annotation>
                                                            <xs:simpleType>
                                                                <xs:restriction base="xs:string">
                                                                    <xs:enumeration value="false"/>
                                                                    <xs:enumeration value="true"/>
                                                                </xs:restriction>
                                                            </xs:simpleType>
                                                        </xs:attribute>
                                                        <xs:attribute name="IsForeignKey" use="required">
                                                            <xs:annotation>
                                                                <xs:documentation>
                                                                    If this column is the foreign key
                                                                </xs:documentation>
                                                            </xs:annotation>
                                                            <xs:simpleType>
                                                                <xs:restriction base="xs:string">
                                                                    <xs:enumeration value="false"/>
                                                                    <xs:enumeration value="true"/>
                                                                </xs:restriction>
                                                            </xs:simpleType>
                                                        </xs:attribute>
                                                        <xs:attribute name="IsNull" use="required">
                                                            <xs:annotation>
                                                                <xs:documentation>
                                                                    If this row can be null.  
                                                                    If table is already made, cannot make column that is not null
                                                                </xs:documentation>
                                                            </xs:annotation>
                                                            <xs:simpleType>
                                                                <xs:restriction base="xs:string">
                                                                    <xs:enumeration value="true"/>
                                                                    <xs:enumeration value="false"/>
                                                                </xs:restriction>
                                                            </xs:simpleType>
                                                        </xs:attribute>
                                                    </xs:complexType>
                                                </xs:element>
                                                <xs:element name="Rows" minOccurs="0" maxOccurs="1">
                                                    <xs:annotation>
                                                        <xs:documentation>
                                                            Values you must include in this config: &lt;SQLConvertFlags&gt; config values and any varchars
                                                        </xs:documentation>
                                                    </xs:annotation>
                                                    <xs:complexType>
                                                        <xs:sequence>
                                                            <xs:element name="Row" minOccurs="0" maxOccurs="unbounded">
                                                                <xs:annotation>
                                                                    <xs:documentation>
                                                                        For this row to be inserted, the table must have an ExternalID and LastAccessDate
                                                                    </xs:documentation>
                                                                </xs:annotation>
                                                                <xs:complexType>
                                                                    <xs:sequence>
                                                                        <xs:element name="Value" minOccurs="1" maxOccurs="unbounded">
                                                                            <xs:annotation>
                                                                                <xs:documentation>
                                                                                    The value you are inserting for the specified column.  
                                                                                </xs:documentation>
                                                                            </xs:annotation>
                                                                            <xs:complexType>
                                                                                <xs:simpleContent>
                                                                                    <xs:extension base="xs:string">
                                                                                        <xs:attribute name="ColumnName" type="xs:string" use="required"/>
                                                                                    </xs:extension>
                                                                                </xs:simpleContent>
                                                                            </xs:complexType>
                                                                        </xs:element>
                                                                    </xs:sequence>
                                                                </xs:complexType>
                                                            </xs:element>
                                                        </xs:sequence>
                                                    </xs:complexType>
                                                </xs:element>
                                            </xs:sequence>
                                            <xs:attribute name="Name">
                                                <xs:annotation>
                                                    <xs:documentation>
                                                        Name of the table you are creating
                                                    </xs:documentation>
                                                </xs:annotation>
                                            </xs:attribute>
                                        </xs:complexType>
                                    </xs:element>
                                </xs:sequence>
                            </xs:complexType>
                        </xs:element>
                    </xs:sequence>
                </xs:complexType>
            </xs:element>
        </xs:sequence>
    </xs:group>

    <xs:group name="MathClass">
        <xs:sequence>
            <xs:element name="Math">
                <xs:complexType>
                    <xs:sequence>
                        <xs:element name="QuantizedStepSize" type="xs:int" minOccurs="0" maxOccurs="1">
                            <xs:annotation>
                                <xs:documentation>
                                    Used for Quantizing method
                                </xs:documentation>
                            </xs:annotation>
                        </xs:element>
                        <xs:element name="PathToGradeImport" type="xs:string" minOccurs="0" maxOccurs="1">
                            <xs:annotation>
                                <xs:documentation>
                                    Path to import file for grades
                                </xs:documentation>
                            </xs:annotation>
                        </xs:element>
                        <xs:element name="GradeColors" minOccurs="0" maxOccurs="1">
                            <xs:annotation>
                                <xs:documentation>
                                    Color configuration.  Must list Descending Minimum Thresholds Values 
                                </xs:documentation>
                            </xs:annotation>
                            <xs:complexType>
                                <xs:sequence>
                                    <xs:element name="GradeColor" minOccurs="0" maxOccurs="unbounded">
                                        <xs:annotation>
                                            <xs:documentation>
                                                Must be colors from powershell terminal
                                            </xs:documentation>
                                        </xs:annotation>
                                        <xs:complexType>
                                            <xs:simpleContent>
                                                <xs:extension base="xs:string">
                                                    <xs:attribute name="MinimumThreshold" type="xs:double">
                                                        <xs:annotation>
                                                            <xs:documentation>
                                                                Values must be in descending order.  
                                                                Maximum Threshold is 100%
                                                            </xs:documentation>
                                                        </xs:annotation>
                                                    </xs:attribute>
                                                </xs:extension>
                                            </xs:simpleContent>
                                        </xs:complexType>
                                    </xs:element>
                                </xs:sequence>
                            </xs:complexType>
                        </xs:element>
                    </xs:sequence>
                </xs:complexType>
            </xs:element>
        </xs:sequence>
    </xs:group>

    <xs:group name="CalendarClass">
        <xs:sequence>
            <xs:element name="Calendar">
                <xs:complexType>
                    <xs:sequence>
                        <xs:element name="PathToEventImport" type="xs:string" minOccurs="0" maxOccurs="1">
                            <xs:annotation>
                                <xs:documentation>
                                    File path to the import file.  
                                    Columns: ExternalID(Format MMddyyyy),Subject,EventDate,IsAnnual
                                </xs:documentation>
                            </xs:annotation>
                        </xs:element>
                        <xs:element name="EventConfig" type="xs:string" minOccurs="0" maxOccurs="1">
                            <xs:annotation>
                                <xs:documentation>
                                    Default: XML.  Choices = XML or Database
                                </xs:documentation>
                            </xs:annotation>
                        </xs:element>
                        <xs:element name="TimeStampFilePath" type="xs:string" minOccurs="0" maxOccurs="1">
                            <xs:annotation>
                                <xs:documentation>
                                    Full path to timestamp.csv
                                </xs:documentation>
                            </xs:annotation>
                        </xs:element>
                        <xs:element name="FirstDayOfWeek" type="xs:string" minOccurs="0" maxOccurs="1">
                            <xs:annotation>
                                <xs:documentation>
                                    First Day of the week
                                </xs:documentation>
                            </xs:annotation>
                        </xs:element>
                    </xs:sequence>
                </xs:complexType>
            </xs:element>
        </xs:sequence>
    </xs:group>

    <xs:group name="List">
        <xs:sequence>
            <xs:element name="Item">
                <xs:annotation>
                    <xs:documentation>
                        You can include as many 'Item' tags, so long as you specify the rank of the item.  
                        The last one should not have any text within the node.
                    </xs:documentation>
                </xs:annotation>
                <xs:complexType>
                    <xs:sequence>
                        <xs:group ref="List"/>
                    </xs:sequence>
                    <xs:attribute name="rank" type="xs:int" use="required"/>
                    <xs:attribute name="name" type="xs:string" use="required"/>
                    <xs:attribute name="Completed" type="xs:boolean" use="required"/>
                    <xs:attribute name="ID" type="xs:string" use="optional"/>
                </xs:complexType>
            </xs:element>
        </xs:sequence>
    </xs:group>

    <xs:attributeGroup name="SecurityType">
        <xs:attribute name="SecType" use="required"> 
            <xs:simpleType>
                <xs:restriction base="xs:string">
                    <xs:enumeration value="public"/>
                    <xs:enumeration value="private"/>
                </xs:restriction>
            </xs:simpleType>
        </xs:attribute>
    </xs:attributeGroup>
</xs:schema>